{% extends "base.html" %}

{% block title %}Edit Product - Professional Inventory{% endblock %}

{% block content %}
<div class="container-fluid">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2><i class="fas fa-edit me-2"></i>Edit Product</h2>
        <a href="{{ url_for('professional_inventory') }}" class="btn btn-secondary">
            <i class="fas fa-arrow-left me-2"></i>Back to Inventory
        </a>
    </div>

    <div class="row">
        <div class="col-lg-8">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0">Product Details</h5>
                </div>
                <div class="card-body">
                    <form method="POST" action="{{ url_for('edit_inventory_product', product_id=product.product_id) }}">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="product_code" class="form-label">Product Code *</label>
                                    <input type="text" class="form-control" id="product_code" name="product_code" value="{{ product.product_code }}" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="barcode" class="form-label">Barcode</label>
                                    <input type="text" class="form-control" id="barcode" name="barcode" value="{{ product.barcode or '' }}">
                                </div>
                            </div>
                        </div>

                        <div class="mb-3">
                            <label for="name" class="form-label">Product Name *</label>
                            <input type="text" class="form-control" id="name" name="name" value="{{ product.name }}" required>
                        </div>

                        <div class="mb-3">
                            <label for="description" class="form-label">Description</label>
                            <textarea class="form-control" id="description" name="description" rows="3">{{ product.description or '' }}</textarea>
                        </div>

                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="category_id" class="form-label">Category</label>
                                    <select class="form-select" id="category_id" name="category_id">
                                        <option value="">Select Category</option>
                                        {% for category in categories %}
                                        <option value="{{ category.category_id }}" {% if product.category_id == category.category_id %}selected{% endif %}>{{ category.category_name }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="supplier_id" class="form-label">Supplier</label>
                                    <select class="form-select" id="supplier_id" name="supplier_id">
                                        <option value="">Select Supplier</option>
                                        {% for supplier in suppliers %}
                                        <option value="{{ supplier.supplier_id }}" {% if product.supplier_id == supplier.supplier_id %}selected{% endif %}>{{ supplier.supplier_name }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label for="unit" class="form-label">Unit</label>
                                    <select class="form-select" id="unit" name="unit">
                                        <option value="pcs" {% if product.unit == 'pcs' %}selected{% endif %}>Pieces</option>
                                        <option value="kg" {% if product.unit == 'kg' %}selected{% endif %}>Kilogram</option>
                                        <option value="liter" {% if product.unit == 'liter' %}selected{% endif %}>Liter</option>
                                        <option value="gram" {% if product.unit == 'gram' %}selected{% endif %}>Gram</option>
                                        <option value="ml" {% if product.unit == 'ml' %}selected{% endif %}>Milliliter</option>
                                        <option value="box" {% if product.unit == 'box' %}selected{% endif %}>Box</option>
                                        <option value="bottle" {% if product.unit == 'bottle' %}selected{% endif %}>Bottle</option>
                                        <option value="tube" {% if product.unit == 'tube' %}selected{% endif %}>Tube</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label for="unit_cost" class="form-label">Unit Cost</label>
                                    <input type="number" class="form-control" id="unit_cost" name="unit_cost" step="0.01" min="0" value="{{ product.unit_cost or 0 }}">
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label for="selling_price" class="form-label">Selling Price</label>
                                    <input type="number" class="form-control" id="selling_price" name="selling_price" step="0.01" min="0" value="{{ product.selling_price or 0 }}">
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label for="current_stock" class="form-label">Current Stock</label>
                                    <input type="number" class="form-control" id="current_stock" name="current_stock" step="0.01" min="0" value="{{ product.current_stock or 0 }}">
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label for="reorder_level" class="form-label">Reorder Level</label>
                                    <input type="number" class="form-control" id="reorder_level" name="reorder_level" min="0" value="{{ product.reorder_level or 0 }}">
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label for="max_stock_level" class="form-label">Max Stock Level</label>
                                    <input type="number" class="form-control" id="max_stock_level" name="max_stock_level" min="0" value="{{ product.max_stock_level or '' }}">
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-check mb-3">
                                    <input class="form-check-input" type="checkbox" id="is_batch_tracked" name="is_batch_tracked" {% if product.is_batch_tracked %}checked{% endif %}>
                                    <label class="form-check-label" for="is_batch_tracked">
                                        Enable Batch Tracking
                                    </label>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-check mb-3">
                                    <input class="form-check-input" type="checkbox" id="is_expiry_tracked" name="is_expiry_tracked" {% if product.is_expiry_tracked %}checked{% endif %}>
                                    <label class="form-check-label" for="is_expiry_tracked">
                                        Enable Expiry Tracking
                                    </label>
                                </div>
                            </div>
                        </div>

                        <div class="d-flex gap-2">
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-save me-2"></i>Update Product
                            </button>
                            <a href="{{ url_for('professional_inventory') }}" class="btn btn-secondary">Cancel</a>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <div class="col-lg-4">
            <div class="card">
                <div class="card-header">
                    <h6 class="mb-0">Product Information</h6>
                </div>
                <div class="card-body">
                    <p><strong>Created:</strong> {{ product.created_at.strftime('%Y-%m-%d %H:%M') if product.created_at else 'Unknown' }}</p>
                    <p><strong>Created By:</strong> {{ product.created_by or 'Unknown' }}</p>
                    {% if product.updated_at %}
                    <p><strong>Last Updated:</strong> {{ product.updated_at.strftime('%Y-%m-%d %H:%M') }}</p>
                    <p><strong>Updated By:</strong> {{ product.updated_by or 'Unknown' }}</p>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}