
{% extends "base.html" %}
{% block title %}Inventory Master Management{% endblock %}

{% block extra_css %}
<style>
    .master-header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 2rem 0;
        margin-bottom: 2rem;
        border-radius: 0 0 15px 15px;
    }

    .master-card {
        border: none;
        border-radius: 15px;
        box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        transition: all 0.3s ease;
        overflow: hidden;
    }

    .master-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 15px 35px rgba(0,0,0,0.15);
    }

    .master-tabs .nav-link {
        border: none;
        border-radius: 10px 10px 0 0;
        padding: 1rem 2rem;
        font-weight: 600;
        margin-right: 5px;
        transition: all 0.3s ease;
    }

    .master-tabs .nav-link:hover {
        background-color: #f8f9fa;
        transform: translateY(-2px);
    }

    .master-tabs .nav-link.active {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
    }

    .data-card {
        background: white;
        border-radius: 12px;
        padding: 1.5rem;
        margin-bottom: 1rem;
        box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        border-left: 4px solid #667eea;
        transition: all 0.3s ease;
    }

    .data-card:hover {
        box-shadow: 0 8px 25px rgba(0,0,0,0.12);
        transform: translateX(5px);
    }

    .action-btn {
        padding: 0.5rem 1rem;
        border-radius: 8px;
        border: none;
        font-weight: 500;
        transition: all 0.3s ease;
        margin: 0 0.25rem;
    }

    .action-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    }

    .form-control, .form-select {
        border-radius: 10px;
        border: 2px solid #e9ecef;
        padding: 0.75rem 1rem;
        transition: all 0.3s ease;
    }

    .form-control:focus, .form-select:focus {
        border-color: #667eea;
        box-shadow: 0 0 0 0.2rem rgba(102, 126, 234, 0.25);
    }

    .empty-state {
        text-align: center;
        padding: 4rem 2rem;
        background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        border-radius: 15px;
        margin: 2rem 0;
    }

    .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1.5rem;
        margin-bottom: 2rem;
    }

    .stat-card {
        background: white;
        padding: 1.5rem;
        border-radius: 12px;
        text-align: center;
        box-shadow: 0 4px 15px rgba(0,0,0,0.08);
    }

    .stat-number {
        font-size: 2rem;
        font-weight: 700;
        margin-bottom: 0.5rem;
    }

    .search-section {
        background: white;
        padding: 1.5rem;
        border-radius: 12px;
        margin-bottom: 2rem;
        box-shadow: 0 4px 15px rgba(0,0,0,0.08);
    }
</style>
{% endblock %}

{% block content %}
<div class="container-fluid px-4">
    <!-- Header Section -->
    <div class="master-header">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-8">
                    <h1 class="h2 mb-2">
                        <i class="fas fa-database me-3"></i>
                        Inventory Master Management
                    </h1>
                    <p class="mb-0 opacity-75">Manage categories, suppliers, and master data for your inventory system</p>
                </div>
                <div class="col-md-4 text-end">
                    <button class="btn btn-light btn-lg" onclick="exportMasterData()">
                        <i class="fas fa-download me-2"></i>Export Data
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Statistics Overview -->
    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-number text-primary">{{ categories|length }}</div>
            <div class="text-muted">Categories</div>
        </div>
        <div class="stat-card">
            <div class="stat-number text-success">{{ suppliers|length }}</div>
            <div class="text-muted">Suppliers</div>
        </div>
        <div class="stat-card">
            <div class="stat-number text-info">{{ active_categories }}</div>
            <div class="text-muted">Active Categories</div>
        </div>
        <div class="stat-card">
            <div class="stat-number text-warning">{{ active_suppliers }}</div>
            <div class="text-muted">Active Suppliers</div>
        </div>
    </div>

    <!-- Main Content Tabs -->
    <div class="master-card">
        <div class="card-header bg-transparent border-0 p-0">
            <ul class="nav nav-tabs master-tabs" id="masterTabs" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="categories-tab" data-bs-toggle="tab" data-bs-target="#categories-pane" type="button" role="tab">
                        <i class="fas fa-tags me-2"></i>Categories
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="suppliers-tab" data-bs-toggle="tab" data-bs-target="#suppliers-pane" type="button" role="tab">
                        <i class="fas fa-truck me-2"></i>Suppliers
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="settings-tab" data-bs-toggle="tab" data-bs-target="#settings-pane" type="button" role="tab">
                        <i class="fas fa-cog me-2"></i>Settings
                    </button>
                </li>
            </ul>
        </div>
        
        <div class="card-body">
            <div class="tab-content" id="masterTabContent">
                
                <!-- Categories Management Tab -->
                <div class="tab-pane fade show active" id="categories-pane" role="tabpanel">
                    <!-- Search and Add Section -->
                    <div class="search-section">
                        <div class="row g-3 align-items-end">
                            <div class="col-md-6">
                                <label class="form-label fw-semibold">Search Categories</label>
                                <div class="input-group">
                                    <span class="input-group-text bg-light">
                                        <i class="fas fa-search text-muted"></i>
                                    </span>
                                    <input type="text" class="form-control" id="searchCategories" 
                                           placeholder="Search by name or description..." onkeyup="filterCategories()">
                                </div>
                            </div>
                            <div class="col-md-3">
                                <label class="form-label fw-semibold">Filter by Status</label>
                                <select class="form-select" id="categoryStatusFilter" onchange="filterCategories()">
                                    <option value="">All Status</option>
                                    <option value="active">Active Only</option>
                                    <option value="inactive">Inactive Only</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <button class="btn btn-primary w-100" data-bs-toggle="modal" data-bs-target="#addCategoryModal">
                                    <i class="fas fa-plus me-2"></i>Add Category
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Categories List -->
                    <div class="row" id="categoriesContainer">
                        {% if categories %}
                            {% for category in categories %}
                            <div class="col-md-6 mb-3 category-item" data-name="{{ category.category_name|lower }}" data-status="{{ 'active' if category.is_active else 'inactive' }}">
                                <div class="data-card">
                                    <div class="d-flex justify-content-between align-items-start mb-3">
                                        <div class="flex-grow-1">
                                            <h5 class="mb-1">{{ category.category_name }}</h5>
                                            {% if category.description %}
                                            <p class="text-muted mb-2">{{ category.description }}</p>
                                            {% endif %}
                                        </div>
                                        <span class="badge {{ 'bg-success' if category.is_active else 'bg-secondary' }} ms-2">
                                            {{ 'Active' if category.is_active else 'Inactive' }}
                                        </span>
                                    </div>
                                    <div class="d-flex justify-content-between align-items-center">
                                        <small class="text-muted">
                                            <i class="fas fa-calendar me-1"></i>
                                            Created: {{ category.created_at.strftime('%d/%m/%Y') if category.created_at else 'N/A' }}
                                        </small>
                                        <div class="action-buttons">
                                            <button class="action-btn btn btn-outline-primary btn-sm" 
                                                    onclick="editCategory({{ category.category_id }}, '{{ category.category_name }}', '{{ category.description or '' }}', {{ category.is_active|lower }})">
                                                <i class="fas fa-edit"></i>
                                            </button>
                                            <button class="action-btn btn btn-outline-danger btn-sm" 
                                                    onclick="deleteCategory({{ category.category_id }}, '{{ category.category_name }}')">
                                                <i class="fas fa-trash"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
                        {% else %}
                        <div class="col-12">
                            <div class="empty-state">
                                <i class="fas fa-tags fa-4x text-muted mb-4"></i>
                                <h4 class="text-muted">No categories found</h4>
                                <p class="text-muted mb-4">Create your first inventory category to organize your products.</p>
                                <button class="btn btn-primary btn-lg" data-bs-toggle="modal" data-bs-target="#addCategoryModal">
                                    <i class="fas fa-plus me-2"></i>Create First Category
                                </button>
                            </div>
                        </div>
                        {% endif %}
                    </div>
                </div>

                <!-- Suppliers Management Tab -->
                <div class="tab-pane fade" id="suppliers-pane" role="tabpanel">
                    <!-- Search and Add Section -->
                    <div class="search-section">
                        <div class="row g-3 align-items-end">
                            <div class="col-md-6">
                                <label class="form-label fw-semibold">Search Suppliers</label>
                                <div class="input-group">
                                    <span class="input-group-text bg-light">
                                        <i class="fas fa-search text-muted"></i>
                                    </span>
                                    <input type="text" class="form-control" id="searchSuppliers" 
                                           placeholder="Search by name, contact, or email..." onkeyup="filterSuppliers()">
                                </div>
                            </div>
                            <div class="col-md-3">
                                <label class="form-label fw-semibold">Filter by Status</label>
                                <select class="form-select" id="supplierStatusFilter" onchange="filterSuppliers()">
                                    <option value="">All Status</option>
                                    <option value="active">Active Only</option>
                                    <option value="inactive">Inactive Only</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <button class="btn btn-success w-100" data-bs-toggle="modal" data-bs-target="#addSupplierModal">
                                    <i class="fas fa-plus me-2"></i>Add Supplier
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Suppliers List -->
                    <div class="row" id="suppliersContainer">
                        {% if suppliers %}
                            {% for supplier in suppliers %}
                            <div class="col-md-6 mb-3 supplier-item" data-name="{{ supplier.supplier_name|lower }}" data-status="{{ 'active' if supplier.is_active else 'inactive' }}">
                                <div class="data-card">
                                    <div class="d-flex justify-content-between align-items-start mb-3">
                                        <div class="flex-grow-1">
                                            <h5 class="mb-1">{{ supplier.supplier_name }}</h5>
                                            {% if supplier.contact_person %}
                                            <p class="mb-1"><i class="fas fa-user me-1"></i>{{ supplier.contact_person }}</p>
                                            {% endif %}
                                            {% if supplier.phone %}
                                            <p class="mb-1"><i class="fas fa-phone me-1"></i>{{ supplier.phone }}</p>
                                            {% endif %}
                                            {% if supplier.email %}
                                            <p class="mb-2"><i class="fas fa-envelope me-1"></i>{{ supplier.email }}</p>
                                            {% endif %}
                                        </div>
                                        <span class="badge {{ 'bg-success' if supplier.is_active else 'bg-secondary' }} ms-2">
                                            {{ 'Active' if supplier.is_active else 'Inactive' }}
                                        </span>
                                    </div>
                                    <div class="d-flex justify-content-between align-items-center">
                                        <small class="text-muted">
                                            <i class="fas fa-calendar me-1"></i>
                                            Added: {{ supplier.created_at.strftime('%d/%m/%Y') if supplier.created_at else 'N/A' }}
                                        </small>
                                        <div class="action-buttons">
                                            <button class="action-btn btn btn-outline-info btn-sm" 
                                                    onclick="viewSupplierDetails({{ supplier.supplier_id }})">
                                                <i class="fas fa-eye"></i>
                                            </button>
                                            <button class="action-btn btn btn-outline-primary btn-sm" 
                                                    onclick="editSupplier({{ supplier.supplier_id }})">
                                                <i class="fas fa-edit"></i>
                                            </button>
                                            <button class="action-btn btn btn-outline-danger btn-sm" 
                                                    onclick="deleteSupplier({{ supplier.supplier_id }}, '{{ supplier.supplier_name }}')">
                                                <i class="fas fa-trash"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
                        {% else %}
                        <div class="col-12">
                            <div class="empty-state">
                                <i class="fas fa-truck fa-4x text-muted mb-4"></i>
                                <h4 class="text-muted">No suppliers found</h4>
                                <p class="text-muted mb-4">Add your first supplier to start managing your inventory sources.</p>
                                <button class="btn btn-success btn-lg" data-bs-toggle="modal" data-bs-target="#addSupplierModal">
                                    <i class="fas fa-plus me-2"></i>Add First Supplier
                                </button>
                            </div>
                        </div>
                        {% endif %}
                    </div>
                </div>

                <!-- Settings Tab -->
                <div class="tab-pane fade" id="settings-pane" role="tabpanel">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="master-card">
                                <div class="card-header bg-light">
                                    <h6 class="mb-0">Category Settings</h6>
                                </div>
                                <div class="card-body">
                                    <div class="mb-3">
                                        <label class="form-label">Default Category for New Items</label>
                                        <select class="form-select">
                                            <option value="">Select Default Category</option>
                                            {% for category in categories %}
                                            <option value="{{ category.category_id }}">{{ category.category_name }}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                    <div class="form-check mb-3">
                                        <input class="form-check-input" type="checkbox" id="autoCreateCategories">
                                        <label class="form-check-label" for="autoCreateCategories">
                                            Auto-create categories during import
                                        </label>
                                    </div>
                                    <button class="btn btn-primary">Save Category Settings</button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="master-card">
                                <div class="card-header bg-light">
                                    <h6 class="mb-0">Supplier Settings</h6>
                                </div>
                                <div class="card-body">
                                    <div class="mb-3">
                                        <label class="form-label">Default Supplier Rating</label>
                                        <select class="form-select">
                                            <option value="3">3 Stars (Average)</option>
                                            <option value="4">4 Stars (Good)</option>
                                            <option value="5">5 Stars (Excellent)</option>
                                        </select>
                                    </div>
                                    <div class="form-check mb-3">
                                        <input class="form-check-input" type="checkbox" id="requireSupplierApproval">
                                        <label class="form-check-label" for="requireSupplierApproval">
                                            Require approval for new suppliers
                                        </label>
                                    </div>
                                    <button class="btn btn-success">Save Supplier Settings</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Add Category Modal -->
<div class="modal fade" id="addCategoryModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header bg-primary text-white">
                <h5 class="modal-title">
                    <i class="fas fa-tags me-2"></i>Add New Category
                </h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <form action="{{ url_for('add_inventory_category') }}" method="POST">
                <div class="modal-body">
                    <div class="mb-3">
                        <label for="categoryName" class="form-label fw-semibold">Category Name *</label>
                        <input type="text" class="form-control" id="categoryName" name="category_name" required>
                    </div>
                    <div class="mb-3">
                        <label for="categoryDescription" class="form-label fw-semibold">Description</label>
                        <textarea class="form-control" id="categoryDescription" name="description" rows="3" 
                                  placeholder="Brief description of this category..."></textarea>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="categoryActive" name="is_active" checked>
                        <label class="form-check-label" for="categoryActive">
                            Active Category
                        </label>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save me-2"></i>Create Category
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Edit Category Modal -->
<div class="modal fade" id="editCategoryModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header bg-warning text-dark">
                <h5 class="modal-title">
                    <i class="fas fa-edit me-2"></i>Edit Category
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <form id="editCategoryForm" method="POST">
                <div class="modal-body">
                    <div class="mb-3">
                        <label for="editCategoryName" class="form-label fw-semibold">Category Name *</label>
                        <input type="text" class="form-control" id="editCategoryName" name="category_name" required>
                    </div>
                    <div class="mb-3">
                        <label for="editCategoryDescription" class="form-label fw-semibold">Description</label>
                        <textarea class="form-control" id="editCategoryDescription" name="description" rows="3"></textarea>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="editCategoryActive" name="is_active">
                        <label class="form-check-label" for="editCategoryActive">
                            Active Category
                        </label>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-warning">
                        <i class="fas fa-save me-2"></i>Update Category
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Add Supplier Modal -->
<div class="modal fade" id="addSupplierModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header bg-success text-white">
                <h5 class="modal-title">
                    <i class="fas fa-truck me-2"></i>Add New Supplier
                </h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <form action="{{ url_for('add_supplier') }}" method="POST">
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="supplierName" class="form-label fw-semibold">Supplier Name *</label>
                                <input type="text" class="form-control" id="supplierName" name="supplier_name" required>
                            </div>
                            <div class="mb-3">
                                <label for="contactPerson" class="form-label fw-semibold">Contact Person</label>
                                <input type="text" class="form-control" id="contactPerson" name="contact_person">
                            </div>
                            <div class="mb-3">
                                <label for="phone" class="form-label fw-semibold">Phone</label>
                                <input type="tel" class="form-control" id="phone" name="phone">
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="email" class="form-label fw-semibold">Email</label>
                                <input type="email" class="form-control" id="email" name="email">
                            </div>
                            <div class="mb-3">
                                <label for="website" class="form-label fw-semibold">Website</label>
                                <input type="url" class="form-control" id="website" name="website">
                            </div>
                            <div class="mb-3">
                                <label for="rating" class="form-label fw-semibold">Rating</label>
                                <select class="form-select" id="rating" name="rating">
                                    <option value="1">1 Star</option>
                                    <option value="2">2 Stars</option>
                                    <option value="3" selected>3 Stars</option>
                                    <option value="4">4 Stars</option>
                                    <option value="5">5 Stars</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="mb-3">
                        <label for="address" class="form-label fw-semibold">Address</label>
                        <textarea class="form-control" id="address" name="address" rows="2"></textarea>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="supplierActive" name="is_active" checked>
                        <label class="form-check-label" for="supplierActive">
                            Active Supplier
                        </label>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-success">
                        <i class="fas fa-save me-2"></i>Create Supplier
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Edit Supplier Modal -->
<div class="modal fade" id="editSupplierModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header bg-warning text-dark">
                <h5 class="modal-title">
                    <i class="fas fa-edit me-2"></i>Edit Supplier
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <form id="editSupplierForm" method="POST">
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="editSupplierName" class="form-label fw-semibold">Supplier Name *</label>
                                <input type="text" class="form-control" id="editSupplierName" name="supplier_name" required>
                            </div>
                            <div class="mb-3">
                                <label for="editContactPerson" class="form-label fw-semibold">Contact Person</label>
                                <input type="text" class="form-control" id="editContactPerson" name="contact_person">
                            </div>
                            <div class="mb-3">
                                <label for="editPhone" class="form-label fw-semibold">Phone</label>
                                <input type="tel" class="form-control" id="editPhone" name="phone">
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="editEmail" class="form-label fw-semibold">Email</label>
                                <input type="email" class="form-control" id="editEmail" name="email">
                            </div>
                            <div class="mb-3">
                                <label for="editWebsite" class="form-label fw-semibold">Website</label>
                                <input type="url" class="form-control" id="editWebsite" name="website">
                            </div>
                            <div class="mb-3">
                                <label for="editRating" class="form-label fw-semibold">Rating</label>
                                <select class="form-select" id="editRating" name="rating">
                                    <option value="1">1 Star</option>
                                    <option value="2">2 Stars</option>
                                    <option value="3">3 Stars</option>
                                    <option value="4">4 Stars</option>
                                    <option value="5">5 Stars</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="mb-3">
                        <label for="editAddress" class="form-label fw-semibold">Address</label>
                        <textarea class="form-control" id="editAddress" name="address" rows="2"></textarea>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="editSupplierActive" name="is_active">
                        <label class="form-check-label" for="editSupplierActive">
                            Active Supplier
                        </label>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-warning">
                        <i class="fas fa-save me-2"></i>Update Supplier
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script>
// Filter Categories
function filterCategories() {
    const search = document.getElementById('searchCategories').value.toLowerCase();
    const status = document.getElementById('categoryStatusFilter').value;
    const items = document.querySelectorAll('.category-item');
    
    let visibleCount = 0;
    items.forEach(item => {
        const name = item.dataset.name;
        const itemStatus = item.dataset.status;
        
        const matchSearch = name.includes(search);
        const matchStatus = !status || itemStatus === status;
        
        if (matchSearch && matchStatus) {
            item.style.display = '';
            visibleCount++;
        } else {
            item.style.display = 'none';
        }
    });
}

// Filter Suppliers
function filterSuppliers() {
    const search = document.getElementById('searchSuppliers').value.toLowerCase();
    const status = document.getElementById('supplierStatusFilter').value;
    const items = document.querySelectorAll('.supplier-item');
    
    let visibleCount = 0;
    items.forEach(item => {
        const name = item.dataset.name;
        const itemStatus = item.dataset.status;
        
        const matchSearch = name.includes(search);
        const matchStatus = !status || itemStatus === status;
        
        if (matchSearch && matchStatus) {
            item.style.display = '';
            visibleCount++;
        } else {
            item.style.display = 'none';
        }
    });
}

// Edit Category
function editCategory(id, name, description, isActive) {
    document.getElementById('editCategoryName').value = name;
    document.getElementById('editCategoryDescription').value = description;
    document.getElementById('editCategoryActive').checked = isActive;
    document.getElementById('editCategoryForm').action = `/inventory/category/update/${id}`;
    
    new bootstrap.Modal(document.getElementById('editCategoryModal')).show();
}

// Delete Category
function deleteCategory(id, name) {
    if (confirm(`Are you sure you want to delete the category "${name}"? This action cannot be undone.`)) {
        const form = document.createElement('form');
        form.method = 'POST';
        form.action = `/inventory/category/delete/${id}`;
        document.body.appendChild(form);
        form.submit();
    }
}

// Edit Supplier
function editSupplier(id) {
    // Fetch supplier data and populate edit modal
    fetch(`/api/supplier/${id}`)
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                const supplier = data.supplier;
                document.getElementById('editSupplierName').value = supplier.supplier_name;
                document.getElementById('editContactPerson').value = supplier.contact_person || '';
                document.getElementById('editPhone').value = supplier.phone || '';
                document.getElementById('editEmail').value = supplier.email || '';
                document.getElementById('editWebsite').value = supplier.website || '';
                document.getElementById('editRating').value = supplier.rating || 3;
                document.getElementById('editAddress').value = supplier.address || '';
                document.getElementById('editSupplierActive').checked = supplier.is_active;
                document.getElementById('editSupplierForm').action = `/supplier/update/${id}`;
                
                new bootstrap.Modal(document.getElementById('editSupplierModal')).show();
            }
        })
        .catch(error => {
            console.error('Error loading supplier:', error);
            alert('Error loading supplier data');
        });
}

// View Supplier Details
function viewSupplierDetails(id) {
    window.location.href = `/supplier/details/${id}`;
}

// Delete Supplier
function deleteSupplier(id, name) {
    if (confirm(`Are you sure you want to delete the supplier "${name}"? This action cannot be undone.`)) {
        const form = document.createElement('form');
        form.method = 'POST';
        form.action = `/supplier/delete/${id}`;
        document.body.appendChild(form);
        form.submit();
    }
}

// Export Master Data
function exportMasterData() {
    window.location.href = '/inventory/master/export';
}

// Initialize tooltips
document.addEventListener('DOMContentLoaded', function() {
    var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
    var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
        return new bootstrap.Tooltip(tooltipTriggerEl);
    });
});
</script>
{% endblock %}
